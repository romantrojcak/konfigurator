<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Konfigurátor dielcov v3</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background-color: #f9f9f9; }
    table, th, td { border: 1px solid #ccc; border-collapse: collapse; padding: 8px; }
    select, input { margin: 5px; }
    .responsive { overflow-x: auto; }
    .cena, #celkovaCena { font-weight: bold; }
    button { margin: 5px; }
  </style>
</head>
<body>

<h1>Konfigurátor dielcov</h1>

<label for="vyrobca">Výrobca:</label>
<select id="vyrobca" onchange="updateDekory()">
  <option value="">-- Vyber --</option>
  <option value="egger">Egger</option>
  <option value="kronospan">Kronospan</option>
</select>

<label for="material">Typ materiálu (hrúbka):</label>
<select id="material" onchange="updateDekory()">
  <option value="">-- Vyber --</option>
  <option value="18">DTD 18mm</option>
  <option value="36">DTD 36mm</option>
</select>

<label for="dekor">Dekor:</label>
<select id="dekor"></select>

<div class="responsive">
<table id="kusovnik">
  <thead>
    <tr>
      <th>Šírka (mm)</th>
      <th>Výška (mm)</th>
      <th>Počet ks</th>
      <th>Hrana Ľ</th>
      <th>Hrana P</th>
      <th>Hrana H</th>
      <th>Hrana D</th>
      <th>Cena (€)</th>
      <th>Akcia</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><input type="number" class="sirka" oninput="spocitajCenu()" /></td>
      <td><input type="number" class="vyska" oninput="spocitajCenu()" /></td>
      <td><input type="number" class="pocet" value="1" oninput="spocitajCenu()" /></td>
      <td><select onchange='spocitajCenu()'><option value='0'>Žiadna</option><option value='0.4'>0,4 mm</option><option value='0.8'>0,8 mm</option><option value='2'>2 mm</option></select></td>
      <td><select onchange='spocitajCenu()'><option value='0'>Žiadna</option><option value='0.4'>0,4 mm</option><option value='0.8'>0,8 mm</option><option value='2'>2 mm</option></select></td>
      <td><select onchange='spocitajCenu()'><option value='0'>Žiadna</option><option value='0.4'>0,4 mm</option><option value='0.8'>0,8 mm</option><option value='2'>2 mm</option></select></td>
      <td><select onchange='spocitajCenu()'><option value='0'>Žiadna</option><option value='0.4'>0,4 mm</option><option value='0.8'>0,8 mm</option><option value='2'>2 mm</option></select></td>
      <td class="cena">0.00</td>
      <td><button onclick="odstranitRiadok(this)">X</button></td>
    </tr>
  </tbody>
</table>
</div>

<button onclick="pridatRiadok()">+ Pridať diel</button>

<h3>Celková cena: <span id="celkovaCena">0.00</span> €</h3>

<script>
const dekory = {
  "egger": {
    "18": ["Biela", "Dub Bardolino", "Antracit"],
    "36": ["Biela Premium", "Čierna Mat", "Orech Dijon"]
  },
  "kronospan": {
    "18": ["Biela K001", "Dub Natural", "Šedá U112"],
    "36": ["Čierna K003", "Orech H373", "Béžová"]
  }
};

function updateDekory() {
  const vyrobca = document.getElementById("vyrobca").value;
  const hrubka = document.getElementById("material").value;
  const dekorSelect = document.getElementById("dekor");
  dekorSelect.innerHTML = "";
  if (vyrobca && dekory[vyrobca] && dekory[vyrobca][hrubka]) {
    dekory[vyrobca][hrubka].forEach(d => {
      const option = document.createElement("option");
      option.value = d;
      option.text = d;
      dekorSelect.appendChild(option);
    });
  }
}

function spocitajCenu() {
  const rows = document.querySelectorAll("#kusovnik tbody tr");
  let total = 0;
  rows.forEach(row => {
    const sirka = parseFloat(row.querySelector(".sirka").value) || 0;
    const vyska = parseFloat(row.querySelector(".vyska").value) || 0;
    const pocet = parseInt(row.querySelector(".pocet").value) || 0;

    let hrany = row.querySelectorAll("select");
    let cenaHrany = 0;
    hrany.forEach(select => {
      cenaHrany += parseFloat(select.value || 0);
    });

    const obvod = (sirka + vyska) * 2 / 1000;
    const plocha = (sirka * vyska) / 1_000_000;
    const cenaZaM2 = 20;
    const cena = (plocha * cenaZaM2 + cenaHrany) * pocet;
    row.querySelector(".cena").innerText = cena.toFixed(2);
    total += cena;
  });
  document.getElementById("celkovaCena").innerText = total.toFixed(2);
}

function pridatRiadok() {
  const tbody = document.querySelector("#kusovnik tbody");
  const novyRiadok = tbody.rows[0].cloneNode(true);
  novyRiadok.querySelectorAll("input").forEach(input => input.value = input.classList.contains("pocet") ? "1" : "");
  novyRiadok.querySelector(".cena").innerText = "0.00";
  tbody.appendChild(novyRiadok);
}

function odstranitRiadok(button) {
  const row = button.closest("tr");
  const tbody = row.parentNode;
  if (tbody.rows.length > 1) {
    row.remove();
    spocitajCenu();
  }
}
</script>

</body>
</html>
