<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Konfigurátor v4</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background-color: #f2f2f2; }
    table, th, td { border: 1px solid #ccc; border-collapse: collapse; padding: 8px; }
    select, input { margin: 5px; }
    .responsive { overflow-x: auto; }
    .cena, #celkovaCena { font-weight: bold; }
    .form-group { margin-bottom: 10px; }
  </style>
</head>
<body>

<h1>Konfigurátor dielcov – verzia 4</h1>

<div class="form-group">
  <label for="material">Typ materiálu:</label>
  <select id="material" onchange="updateDekory()">
    <option value="">-- Vyber --</option>
    <option value="18egger">18 Egger</option>
  </select>
</div>

<div class="form-group">
  <label for="filterDekor">Vyhľadať dekor:</label>
  <input type="text" id="filterDekor" oninput="filterDekory()" placeholder="Zadaj názov dekoru...">
</div>

<div class="form-group">
  <label for="dekor">Dekor:</label>
  <select id="dekor"></select>
</div>

<div class="responsive">
<table id="kusovnik">
  <thead>
    <tr>
      <th>Šírka (mm)</th>
      <th>Výška (mm)</th>
      <th>Počet ks</th>
      <th>Cena (€)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><input type="number" class="sirka" oninput="spocitajCenu()" /></td>
      <td><input type="number" class="vyska" oninput="spocitajCenu()" /></td>
      <td><input type="number" class="pocet" value="1" oninput="spocitajCenu()" /></td>
      <td class="cena">0.00</td>
    </tr>
  </tbody>
</table>
</div>

<button onclick="pridatRiadok()">+ Pridať diel</button>

<h3>Celková cena: <span id="celkovaCena">0.00</span> €</h3>

<script>
const dekory = {
  "18egger": [
    "W980 Biela",
    "H3331 Dub Nebraska",
    "U999 Čierna",
    "H3730 Orech Dijon",
    "U708 Svetlosivá"
  ]
};

function updateDekory() {
  const material = document.getElementById("material").value;
  const dekorSelect = document.getElementById("dekor");
  dekorSelect.innerHTML = "";

  if (dekory[material]) {
    dekory[material].forEach(d => {
      const option = document.createElement("option");
      option.value = d;
      option.text = d;
      dekorSelect.appendChild(option);
    });
  }

  filterDekory(); // aplikuj filter aj po zmene materiálu
}

function filterDekory() {
  const filter = document.getElementById("filterDekor").value.toLowerCase();
  const dekorSelect = document.getElementById("dekor");
  for (let i = 0; i < dekorSelect.options.length; i++) {
    const option = dekorSelect.options[i];
    option.style.display = option.text.toLowerCase().includes(filter) ? "" : "none";
  }
}

function spocitajCenu() {
  const rows = document.querySelectorAll("#kusovnik tbody tr");
  let total = 0;
  rows.forEach(row => {
    const sirka = parseFloat(row.querySelector(".sirka").value) || 0;
    const vyska = parseFloat(row.querySelector(".vyska").value) || 0;
    const pocet = parseInt(row.querySelector(".pocet").value) || 0;
    const plocha = (sirka * vyska) / 1_000_000;
    const cenaZaM2 = 20;
    const cena = plocha * cenaZaM2 * pocet;
    row.querySelector(".cena").innerText = cena.toFixed(2);
    total += cena;
  });
  document.getElementById("celkovaCena").innerText = total.toFixed(2);
}

function pridatRiadok() {
  const tbody = document.querySelector("#kusovnik tbody");
  const novyRiadok = tbody.rows[0].cloneNode(true);
  novyRiadok.querySelectorAll("input").forEach(input => input.value = input.classList.contains("pocet") ? "1" : "");
  novyRiadok.querySelector(".cena").innerText = "0.00";
  tbody.appendChild(novyRiadok);
}
</script>

</body>
</html>
